# Language setting
language: node_js
# Version number
node_js:
  - 0.12
  
env:
  global:
    - PROJECT_ID="56cdeca3c77dae78a8e9aafd" 
    - secure: h/zlJD40V1f5IX0zelXOgsy5l0o4HF4E2upQ+Cdjv6RCs40Tuey0gv+YC5HqaWMEKSDHa/8WqvyrC5+tyik3izbWml3zCH6yBA+zauPK6dZz6QGkpUK15Zdd0uwqWraGOLmRu/EQi0bicsezGDeXBgh/VgQVfxdDmg/GWIgIveBZXZO0LybXI4ymou+yMh9vBkRzJi/i9Zk50qZAlyh+QSIsHS0acXLKrfS/x0h3tW1EPe743egA+8Dy1BR0ujuZLu2Gi5L0SnNZRPxE3rM7WCpjhiCdayzsXEMP99K0pPh97WD3+srzsQMYaRzFAr1/hCwjKj/LwjOcCS/HQXI3eA==
   # - secure: myqBBb4G21ufRAs7U3xT6Ck/5d503jIjDWMgeX1XLus9dmHYM6taSEQhv9Q38eOw3+SKHSJYLIHL9dZRPVwYVQCyk4mQn6zwW0GEHDLgY7KDEYMPRgR7+Z5p94sQk/j9hJonb0P2xp+mRmMsWO0RkablxPa7RHe0zqq92Av+a0Pl/Up3KPF27UFbSMypJUc0mhk1INenbdU/d1Mrmh9MUWadaRlIjH447GQsB7fxZ+TJ78wNKDt/ZFYWxZo1aHc0wQNIE5dYiGT/kF1HG0/j5NxPv81M61QZyxYxsVBw78THsf5tS0IKGTsLdM6K02IiXbk9itbNGJNT8kv63TLkXA==

build:

  pre_ci:
    - echo $COMMITTER and $LAST_AUTHOR and $COMMIT_MESSAGE
    
  ci:
    - echo $PROJECT_ID
    - echo $COMMITTER and $LAST_AUTHOR and $COMMIT_MESSAGE 
    - 'curl -H "Authorization: apiToken $SHIP_TOKEN" -H "Content-Type: application/json" -d "{\"projectId\": \"$PROJECT_ID\"}" https://apibeta.shippable.com/projects/$PROJECT_ID/newBuild'
  post_ci:
    - echo $COMMITTER and $LAST_AUTHOR and $COMMIT_MESSAGE

integrations:
  
  notifications:
    
    - integrationName: "ship-slack"
      type: slack
      recipients:
        - "pvt2"
        - "#shiphitchcock2test"

      on_failure: always
      on_start: always
      on_success: always
      on_pull_request: always
      
    - integrationName: postci
      type: webhook
      payload:
        - isPRBuild=$IS_PULL_REQUEST
        - branchName=$BRANCH
        - committer= $COMMITTER 
        - author= $LAST_AUTHOR
        - commitmessage= $COMMIT_MESSAGE
        - message=Shippable Run $BUILD_NUMBER ($BUILD_URL) succeeded for $COMPARE_URL
        - FOO=BAR
        - FIZZ=BUZZ
        
      on_failure: always
      on_start: always
      on_success: always
      on_pull_request: always
      
